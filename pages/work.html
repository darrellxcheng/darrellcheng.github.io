<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Darrell Cheng — Work & Projects</title>
    <meta name="description" content="Portfolio of projects and work by Darrell Cheng - Software Engineering, Bioinformatics, and Technical Art" />
    
    <!-- Open Graph / Twitter -->
    <meta property="og:title" content="Darrell Cheng — Work & Projects" />
    <meta property="og:description" content="Portfolio of projects and work by Darrell Cheng" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://darrellcheng.github.io/assets/images/headshotcompressed.jpg" />
    <meta name="twitter:card" content="summary_large_image" />

    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/site.webmanifest">
    <link rel="stylesheet" href="../style.css">
</head>

<body>
    <div class="page-transition">
        <div class="loader"></div>
    </div>

    <header>
        <div class="container nav">
            <div class="brand-container">
                <div class="flipswitch">
                    <input type="checkbox" name="flipswitch" class="flipswitch-cb" id="theme-toggle" checked>
                    <label class="flipswitch-label" for="theme-toggle">
                        <div class="flipswitch-inner">
                            <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="5"></circle>
                                <line x1="12" y1="3" x2="12" y2="5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <line x1="12" y1="19" x2="12" y2="21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <line x1="3" y1="12" x2="5" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <line x1="19" y1="12" x2="21" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <line x1="5.6" y1="5.6" x2="7" y2="7" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <line x1="17" y1="17" x2="18.4" y2="18.4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <line x1="17" y1="7" x2="18.4" y2="5.6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <line x1="5.6" y1="18.4" x2="7" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                            </svg>
                        </div>
                        <div class="flipswitch-switch"></div>
                    </label>
                </div>
                <div class="brand">
                    <img class="profile-dot" src="/assets/images/headshotcompressed.jpg" alt="Darrell Cheng" aria-hidden="true">
                    <span>Darrell Cheng</span>
                </div>
            </div>
            <nav class="links" aria-label="Primary">
                <a href="../index.html">Home</a>
                <a href="../index.html#experience">Experience</a>
                <a href="../index.html#education">Education</a>
                <a href="../index.html#contact">Contact</a>
            </nav>
        </div>
    </header>

    <main id="main" class="container">
        <section class="hero" aria-labelledby="work-title">
            <h1 id="work-title">Work</h1>
            <p>A collection of my personal and professional projects.</p>
        </section>

        <!-- Projects filter toolbar + single grid -->
        <section class="section" aria-labelledby="projects-title">
            <div class="section-header" style="align-items:center; gap:16px;">
                <h2 id="projects-title">Projects</h2>
                <div id="project-filters" class="filters" role="toolbar" aria-label="Filter projects by category">
                    <!-- Buttons injected by JS -->
                </div>
            </div>
            <div class="content">
                <div class="grid" id="projects-grid">
                    <!-- All projects rendered here -->
                </div>
            </div>
        </section>

        
        <!-- Contact Section -->
        <section id="contact" class="section" aria-labelledby="contact-title">
            <h2 id="contact-title">Contact</h2>
            <div class="social">
                <a class="icon-link" href="tel:+14803531378" aria-label="Phone">
                    <svg width="20" height="20" fill="var(--accent)" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24c1.12.37 2.33.57 3.58.57a1 1 0 011 1v3.5a1 1 0 01-1 1C10.07 22 2 13.93 2 4.5A1 1 0 013 3.5H6.5a1 1 0 011 1c0 1.25.2 2.46.57 3.58a1 1 0 01-.24 1.01l-2.2 2.2z"/>
                    </svg>
                </a>
                <a class="icon-link" href="mailto:dc2000a@gmail.com" aria-label="Email">
                    <svg width="20" height="20" fill="var(--accent)" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M20 4H4a2 2 0 00-2 2v12a2 2 0 002 2h16a2 2 0 002-2V6a2 2 0 00-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                    </svg>
                </a>
                <a class="icon-link" href="https://github.com/darrellxcheng" target="_blank" rel="noopener" aria-label="GitHub">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="var(--accent)" aria-hidden="true">
                        <path d="M12 2C6.48 2 2 6.58 2 12.26c0 4.52 2.87 8.35 6.84 9.71.5.1.68-.22.68-.48v-1.7c-2.78.62-3.37-1.37-3.37-1.37-.45-1.18-1.12-1.5-1.12-1.5-.92-.64.07-.63.07-.63 1.02.07 1.56 1.07 1.56 1.07.9 1.58 2.36 1.12 2.94.86.09-.67.35-1.12.63-1.38-2.22-.26-4.55-1.14-4.55-5.06 0-1.12.39-2.03 1.04-2.75-.1-.26-.45-1.3.1-2.7 0 0 .84-.27 2.75 1.04a9.2 9.2 0 015 0c1.9-1.31 2.74-1.04 2.74-1.04.55 1.4.2 2.44.1 2.7.65.72 1.04 1.63 1.04 2.75 0 3.93-2.34 4.79-4.57 5.05.36.32.68.95.68 1.92v2.85c0 .27.18.59.69.49A10.03 10.03 0 0022 12.26C22 6.58 17.52 2 12 2z"/>
                    </svg>
                </a>
                <a class="icon-link" href="https://www.linkedin.com/in/darrell-c-718926194/" target="_blank" rel="noopener" aria-label="LinkedIn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="var(--accent)" aria-hidden="true">
                        <path d="M4.98 3.5C4.98 4.88 3.86 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1s2.48 1.12 2.48 2.5zM.5 8h4V24h-4V8zM8.5 8h3.8v2.2h.05c.53-1 1.82-2.2 3.75-2.2 4 0 4.75 2.63 4.75 6V24h-4v-5.5c0-1.32 0-3-1.85-3s-2.15 1.45-2.15 2.9V24h-4V8z"/>
                    </svg>
                </a>
            </div>
        </section>
    </main>

    <footer class="container">
        <small>© <span id="y"></span> Darrell Cheng. Built with GitHub Pages & hosted via Spaceship.</small>
    </footer>

    <script>
        // Work Page Project Manager
        class WorkProjectManager {
            constructor() {
                this.projects = null;
                this.categories = new Set();
                this.activeFilter = 'all';
                this.loadProjects();
            }

            async loadProjects() {
                try {
                    const response = await fetch('/assets/projects/data/projects.json');
                    this.projects = await response.json();
                    this.extractCategories();
                    this.renderFilterButtons();
                    this.renderAllProjects();
                } catch (error) {
                    console.error('Failed to load projects:', error);
                }
            }

            extractCategories() {
                if (!this.projects) return;
                this.projects.projects.forEach(p => {
                    // Support both `category` string and `categories` array; allow multiple by splitting on commas
                    if (Array.isArray(p.categories)) {
                        p.categories.forEach(c => this.categories.add(c.toLowerCase()));
                    } else if (p.category) {
                        // allow comma-separated categories in category field
                        p.category.toString().split(',').map(s => s.trim()).forEach(c => this.categories.add(c.toLowerCase()));
                    }
                    // Also collect tags as implicit categories (optional)
                });
            }

            renderFilterButtons() {
                const container = document.getElementById('project-filters');
                if (!container) return;

                // Always include 'All'
                const allBtn = document.createElement('button');
                allBtn.className = 'filter-btn active';
                allBtn.dataset.category = 'all';
                allBtn.textContent = 'All';
                allBtn.addEventListener('click', () => this.applyFilter('all'));
                container.appendChild(allBtn);

                Array.from(this.categories).sort().forEach(cat => {
                    const btn = document.createElement('button');
                    btn.className = 'filter-btn';
                    btn.dataset.category = cat;
                    btn.textContent = this.titleCase(cat);
                    btn.addEventListener('click', () => this.applyFilter(cat));
                    container.appendChild(btn);
                });
            }

            titleCase(str) {
                return str.replace(/\w\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substr(1));
            }

            applyFilter(category) {
                this.activeFilter = category;
                // update active button styles
                document.querySelectorAll('#project-filters .filter-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.category === category);
                });
                this.renderAllProjects();
            }

            renderAllProjects() {
                if (!this.projects) return;
                const container = document.getElementById('projects-grid');
                if (!container) return;

                // Normalize project categories into array
                const projectList = this.projects.projects.map(p => {
                    const cats = [];
                    if (Array.isArray(p.categories)) {
                        p.categories.forEach(c => cats.push(c.toLowerCase()));
                    }
                    if (p.category) {
                        p.category.toString().split(',').map(s => s.trim()).forEach(c => cats.push(c.toLowerCase()));
                    }
                    // dedupe
                    p._categories = Array.from(new Set(cats));
                    return p;
                });

                // Filter if needed (activeFilter === 'all' means no filter)
                const visible = projectList.filter(p => {
                    if (this.activeFilter === 'all') return true;
                    return p._categories.includes(this.activeFilter);
                });

                container.innerHTML = visible.map(project => this.createProjectCard(project)).join('');

                // stagger animation delays for visible items
                const galleryItems = container.querySelectorAll('.gallery-item');
                galleryItems.forEach((item, idx) => {
                    item.style.animationDelay = `${(idx + 1) * 0.06}s`;
                });
            }

            createProjectCard(project) {
                return `
                    <article class="card gallery-item" data-categories="${(project._categories||[]).join(' ')}">
                        <a href="${project.link || '#'}" class="card-link" aria-label="View ${project.title} project">
                            <div class="thumb" aria-hidden="true">
                                <img src="${project.image}" alt="${project.title} preview" loading="lazy">
                            </div>
                            <h3>${project.title}</h3>
                            <p>${project.description}</p>
                            <div class="badges">
                                ${(project.tags||[]).map(tag => `<span class="badge">${tag}</span>`).join('')}
                            </div>
                        </a>
                    </article>
                `;
            }
        }

        // Theme toggle functionality
        const themeToggle = document.getElementById('theme-toggle');
        
        const getPreferredTheme = () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) return savedTheme;
            return window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
        };
        
        const setTheme = (theme) => {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            themeToggle.checked = theme === 'light';
        };
        
        setTheme(getPreferredTheme());
        
        themeToggle.addEventListener('change', () => {
            setTheme(themeToggle.checked ? 'light' : 'dark');
        });

        // Collapsible sections with gallery animation
        document.querySelectorAll('.section-header').forEach(header => {
            header.addEventListener('click', () => {
                const section = header.parentElement;
                const isActive = section.classList.contains('active');
                
                if (!isActive) {
                    section.classList.add('active');
                    
                    // Animate gallery items with staggered delay
                    const galleryItems = section.querySelectorAll('.gallery-item');
                    galleryItems.forEach((item, index) => {
                        item.style.animationDelay = `${(index + 1) * 0.1}s`;
                    });
                } else {
                    section.classList.remove('active');
                }
            });

            header.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    header.click();
                }
            });
        });

        // Page transitions
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize project manager
            new WorkProjectManager();
            
            const main = document.querySelector('main');
            const transition = document.querySelector('.page-transition');

            function navigateTo(url) {
                main.classList.add('fade-out');
                
                setTimeout(() => {
                    transition.classList.add('active');
                    
                    setTimeout(() => {
                        window.location.href = url;
                    }, 800);
                }, 500);
            }

            window.addEventListener('load', () => {
                main.classList.remove('fade-out');
                transition.classList.remove('active');
            });
        });

        document.getElementById('y').textContent = new Date().getFullYear();
    </script>
</body>

</html>